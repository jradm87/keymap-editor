{"ast":null,"code":"import _slicedToArray from\"/home/runner/work/keymap-editor/keymap-editor/app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import get from'lodash/get';import keyBy from'lodash/keyBy';import{getBehaviourParams}from'../../keymap';export function makeIndex(tree){var index=[];(function traverse(tree){var params=tree.params||[];index.push(tree);params.forEach(traverse);})(tree);return index;}export function isSimple(normalized){var _normalized$params=_slicedToArray(normalized.params,1),first=_normalized$params[0];var symbol=get(first,'source.symbol',get(first,'source.code',''));var shortSymbol=symbol.length===1;var singleParam=normalized.params.length===1;return singleParam&&shortSymbol;}export function isComplex(normalized,behaviourParams){var _normalized$params2=_slicedToArray(normalized.params,1),first=_normalized$params2[0];var symbol=get(first,'source.symbol',get(first,'value',''));var isLongSymbol=symbol.length>4;var isMultiParam=behaviourParams.length>1;var isNestedParam=get(first,'params',[]).length>0;return isLongSymbol||isMultiParam||isNestedParam;}export function createPromptMessage(param){var promptMapping={layer:'Select layer',mod:'Select modifier',behaviour:'Select behaviour',command:'Select command',keycode:'Select key code'};if(param.name){return\"Select \".concat(param.name);}return promptMapping[param]||promptMapping.keycode;}export function hydrateTree(value,params,sources){var bind=value;var behaviour=get(sources.behaviours,bind);var behaviourParams=getBehaviourParams(params,behaviour);var commands=keyBy(behaviour.commands,'code');function getSourceValue(value,as){var _sources$as;if(as==='command')return commands[value];if(as==='raw'||as.enum)return{code:value};return sources===null||sources===void 0?void 0:(_sources$as=sources[as])===null||_sources$as===void 0?void 0:_sources$as[value];}function hydrateNode(node,as){if(!node){return{value:undefined,params:[]};}var value=node.value,params=node.params;var source=getSourceValue(value,as);return{value:value,source:source,params:get(source,'params',[]).map(function(as,i){return hydrateNode(params[i],as);})};}return{value:value,source:behaviour,params:behaviourParams.map(function(as,i){return hydrateNode(params[i],as);})};}","map":{"version":3,"names":["get","keyBy","getBehaviourParams","makeIndex","tree","index","traverse","params","push","forEach","isSimple","normalized","first","symbol","shortSymbol","length","singleParam","isComplex","behaviourParams","isLongSymbol","isMultiParam","isNestedParam","createPromptMessage","param","promptMapping","layer","mod","behaviour","command","keycode","name","hydrateTree","value","sources","bind","behaviours","commands","getSourceValue","as","enum","code","hydrateNode","node","undefined","source","map","i"],"sources":["/home/runner/work/keymap-editor/keymap-editor/app/src/Keyboard/Keys/util.js"],"sourcesContent":["import get from 'lodash/get'\nimport keyBy from 'lodash/keyBy'\n\nimport { getBehaviourParams } from '../../keymap'\n\nexport function makeIndex (tree) {\n  const index = []\n  ;(function traverse(tree) {\n    const params = tree.params || []\n    index.push(tree)\n    params.forEach(traverse)\n  })(tree)\n\n  return index\n}\n\nexport function isSimple(normalized) {\n  const [first] = normalized.params\n  const symbol = get(first, 'source.symbol', get(first, 'source.code', ''))\n  const shortSymbol = symbol.length === 1\n  const singleParam = normalized.params.length === 1\n  return singleParam && shortSymbol\n}\n\nexport function isComplex(normalized, behaviourParams) {\n  const [first] = normalized.params\n  const symbol = get(first, 'source.symbol', get(first, 'value', ''))\n  const isLongSymbol = symbol.length > 4\n  const isMultiParam = behaviourParams.length > 1\n  const isNestedParam = get(first, 'params', []).length > 0\n\n  return isLongSymbol || isMultiParam || isNestedParam\n}\n\nexport function createPromptMessage(param) {\n  const promptMapping = {\n    layer: 'Select layer',\n    mod: 'Select modifier',\n    behaviour: 'Select behaviour',\n    command: 'Select command',\n    keycode: 'Select key code'\n  }\n\n  if (param.name) {\n    return `Select ${param.name}`\n  }\n\n  return (\n    promptMapping[param] ||\n    promptMapping.keycode\n  )\n}\n\nexport function hydrateTree(value, params, sources) {\n  const bind = value\n  const behaviour = get(sources.behaviours, bind)\n  const behaviourParams = getBehaviourParams(params, behaviour)\n  const commands = keyBy(behaviour.commands, 'code')\n\n  function getSourceValue(value, as) {\n    if (as === 'command') return commands[value]\n    if (as === 'raw' || as.enum) return { code: value }\n    return sources?.[as]?.[value]\n  }\n\n  function hydrateNode(node, as) {\n    if (!node) {\n      return { value: undefined, params: [] }\n    }\n    const { value, params } = node\n    const source = getSourceValue(value, as)\n\n    return {\n      value,\n      source,\n      params: get(source, 'params', []).map((as, i) => (\n        hydrateNode(params[i], as)\n      ))\n    }\n  }\n\n  return {\n    value,\n    source: behaviour,\n    params: behaviourParams.map((as, i) => (\n      hydrateNode(params[i], as)\n    ))\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}